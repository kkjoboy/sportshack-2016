<!DOCTYPE html>
<html>

<head>
    <script>
        //dummy data
        var gameID = "568d84eb-874f-49f4-b77d-dc23412fb87c";//this is the patriots chargers game during our live demo
        var patriotsID = "97354895-8c77-4fd4-a860-32e62ea7382a";
        var cardinalsID = "de760528-1dc0-416a-a978-b510d20692ff";

        //
        var teams = new Array();
        var team1Players = new Array();
        var team2Players = new Array();
        var stats = new Array();
        var currentGameTime;

        var response;
        function switchCompare() {
          	if(document.getElementById("compare").value == "less") {
            	document.getElementById("compare").value = "more";
            } else {
              document.getElementById("compare").value = "less";
            }

        }
        function requestData(url) {
            var xhttp ;
            var response;
            //var url = "http://localhost:8000/nfl-ot1/games/2016/REG/schedule.json?api_key=bnuwzm9vktq7n3pkg5trpnb8";

            xhttp = new XMLHttpRequest();


            xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                //document.getElementById("big").innerHTML = this.responseText;
                response = JSON.parse(this.responseText);

                //alert("Data received");

            }
            };
            xhttp.open("GET", url, false);//SYNCHRONOUS Request!!!!!!!!!
            xhttp.send();

            return response;
        }
        function populateDropdowns() {
            //get teams and populate menus
            var teamsRaw = requestData("http://localhost:8000/nfl-ot1/games/" + gameID + "/statistics.json?api_key=bnuwzm9vktq7n3pkg5trpnb8");
/*            alert("teamsRaw.summary.home.id: " + teamsRaw.summary.home.id);*/
            var playerRaw = requestData("http://localhost:8000/nfl-ot1/teams/" + patriotsID + "/profile.json?api_key=bnuwzm9vktq7n3pkg5trpnb8");
            var player2Raw = requestData("http://localhost:8000/nfl-ot1/teams/" + cardinalsID + "/profile.json?api_key=bnuwzm9vktq7n3pkg5trpnb8");
            var count = 0;
            for (var i = 0; i < playerRaw.players.length; i++) {
                if (playerRaw.players[i].position== "RB" || playerRaw.players[i].position == "TE" || playerRaw.players[i].position == "QB" || playerRaw.players[i].position == "WR") {
                        team1Players[count] = playerRaw.players[i].name;
                        count++;
                }
            }
            count = 0;
            for (var i = 0; i < player2Raw.players.length; i++) {
                if (player2Raw.players[i].position== "RB" || player2Raw.players[i].position == "TE" || player2Raw.players[i].position == "QB" || player2Raw.players[i].position == "WR") {
                        team2Players[count] = player2Raw.players[i].name;
                        count++;
                }

            }

            teams.push(teamsRaw.summary.home.market + " " + teamsRaw.summary.home.name);
            teams.push(teamsRaw.summary.away.market + " " + teamsRaw.summary.away.name);

            var team1 = document.createElement("option");
            var team1Content = document.createTextNode(teams[0]);
            team1.appendChild(team1Content);
            document.getElementById("mySelect").appendChild(team1);

            var team1temp = document.createElement("option");
            var team1Contenttemp = document.createTextNode(teams[0]);
            team1temp.appendChild(team1Contenttemp);
            document.getElementById("mySelect3").appendChild(team1temp);

            var team2 = document.createElement("option");
            var team2Content = document.createTextNode(teams[1]);
            team2.appendChild(team2Content);
            document.getElementById("mySelect").appendChild(team2);

            var team2temp = document.createElement("option");
            var team2Contenttemp = document.createTextNode(teams[1]);
            team2temp.appendChild(team2Contenttemp);
            document.getElementById("mySelect3").appendChild(team2temp);

            //get offensive players for each team


            //cardinals
            //get stats

            //get current game time

            //set time menu


        }
        function removeAllButFirst() {

        }
        function updatePlayerList(value, listeningBoxID) {
            

            if(value == "Select team") {
                alert("please select a team");
            } else if (value == teams[1]) {//if patriots selected, fill listeningBox up with pats players
                for (var i = 0; i < team1Players.length; i++) {
                    var player = document.createElement("option");
                    var playerName = document.createTextNode("" + team1Players[i]);
                    player.appendChild(playerName);
                    //grab the paired drop down in the div
                    var mainDiv = document.getElementById('first select');
                    if(mainDiv == null || mainDiv.length == 0) {
                        mainDiv = document.getElementById('second select');
                    }
                    var childDiv = document.getElementsByTagName('first select')[0],
                    requiredDiv = childDiv.getElementsByTagName('div')[1];

                    document.getElementById(receiver).appendChild(player);
                }
            } else if (value == teams[0]) {
                //cardinals
                alert("got here and value (cardinals) was " + value);
                for (var i = 0; i < team2Players.length; i++) {
                    var player = document.createElement("option");
                    var playerName = document.createTextNode("" + team2Players[i]);
                    player.appendChild(playerName);


                    //grab the paired drop down in the div
                    var receiver = document.getElementByID(listeningBoxID.parentNode.children[1]);


                    document.getElementById(receiver).appendChild(player);
                }
            } else {
                alert("error! in updatePlayerList");
            }



        }

    </script>
</head>

<body>
<input type="button" id = "start" onclick="populateDropdowns()" value="start request">
  <p>I bet user...{ALREADY SELECTED} that during the {selected game} the...
    <form>
        <div id = "first select">
            <select id="mySelect" onchange="updatePlayerList(this.value, this.id)"">
                <option>Select team</option>
            </select>
            <select id="mySelect2" onchange="updatePlayerList(this.value, this.id)"">
                <option>Team</option>
            </select>
        </div>
        will have
        <input type="button" id = "compare" onclick="switchCompare()" value="more">
        <select id="stat">
            <option>Points</option>
            <option>Passing yards</option>
            <option>Fumbles</option>
            <option>Touchdowns</option>
        </select>
        than
        <div id = "second select">
            <select id="mySelect3" onchange="updatePlayerList(this.value, this.id)"">
                <option>Select team</option>
            </select>
            <select id="mySelect4"  onchange="updatePlayerList(this.value, this.id)"">
                <option>Team</option>
            </select>
        </div>
        by
        <select id="mySelect5">
            <option>14:30</option>
            <option>14:00</option>
            <option>13:30</option>
            <option>13:00</option>
        </select>
        <br>
        <br>
        Current Game time (plus a small buffer): 14:42, First Quarter
    </form>
  </p>
</body>

</html>